<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/admin/dashboard"></ion-back-button>
    </ion-buttons>
    <ion-title>Administrar Reportes</ion-title>
  </ion-toolbar>
  <ion-toolbar>
    <ion-segment [value]="(filterStatus | async)" (ionChange)="onFilterChange($event)">
      <ion-segment-button value="all">
        <ion-label>Todos</ion-label>
      </ion-segment-button>
      <ion-segment-button value="pending">
        <ion-label>Pendientes</ion-label>
      </ion-segment-button>
      <ion-segment-button value="reviewed">
        <ion-label>Revisados</ion-label>
      </ion-segment-button>
      <ion-segment-button value="resolved">
        <ion-label>Resueltos</ion-label>
      </ion-segment-button>
      <ion-segment-button value="rejected">
        <ion-label>Rechazados</ion-label>
      </ion-segment-button>
    </ion-segment>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div *ngIf="(reports$ | async)?.length === 0" class="empty-state">
    <div class="empty-icon-wrapper">
      <ion-icon name="document-text-outline"></ion-icon>
    </div>
    <h3 class="empty-title">No hay reportes</h3>
    <p class="empty-message">No hay reportes para mostrar en este momento.</p>
  </div>

  <ion-list *ngIf="((reports$ | async)?.length ?? 0) > 0">
    <ion-card *ngFor="let report of reports$ | async" class="report-card" (click)="viewReport(report.id)">
      <ion-item lines="none">
        <ion-thumbnail slot="start">
          <img [src]="report.petSnapshot?.urlImagen || 'assets/imgs/paw.png'" loading="lazy">
        </ion-thumbnail>
        <ion-label>
          <h2>{{ report.petSnapshot?.nombre || 'Mascota Eliminada/No Encontrada' }}</h2>
          <p>Reportado por: <strong>{{ report.reporter?.nombreCompleto || 'Usuario Eliminado/No Encontrado' }}</strong>
          </p>
          <p *ngIf="report.publisher">Publicador: <strong>{{ report.publisher?.nombreCompleto || 'Usuario Eliminado/No
              Encontrado' }}</strong></p>
          <p>Motivo: {{ report.reason | reportReasonTranslate }}</p>
          <p *ngIf="report.details">Detalles: {{ report.details }}</p>
          <p>Fecha: {{ report.createdAt | date:'medium' }}</p>
          <ion-chip
            [color]="report.status === 'pending' ? 'warning' : report.status === 'reviewed' ? 'primary' : report.status === 'resolved' ? 'success' : report.status === 'rejected' ? 'danger' : 'medium'">
            <ion-label>{{ getSpanishStatus(report.status) | titlecase }}</ion-label>
          </ion-chip>
        </ion-label>
      </ion-item>
    </ion-card>
  </ion-list>
</ion-content>