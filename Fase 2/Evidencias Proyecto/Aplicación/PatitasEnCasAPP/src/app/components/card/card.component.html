<ion-card class="pet-card" role="article" [attr.aria-label]="'Tarjeta de adopción de ' + nombre">
  <div class="image-container">
    <ion-chip 
      *ngIf="status" 
      [color]="getStatusColor(status)" 
      class="status-chip" 
      role="status" 
      aria-live="polite" 
      aria-atomic="true"
      [attr.aria-label]="'Estado: ' + getTranslatedStatus(status)">
      <ion-label>{{ getTranslatedStatus(status) }}</ion-label>
    </ion-chip>
    <ion-skeleton-text *ngIf="imageLoading" animated aria-hidden="true"></ion-skeleton-text>
    <ion-img [src]="urlImagen" (ionError)="handleImageError($event)" (ionImgDidLoad)="onImageLoad()" [hidden]="imageLoading" [alt]="'Foto de ' + (nombre || 'mascota sin nombre') + ', ' + tipoMascota"></ion-img>
  </div>
  <ion-card-header>
    <ion-card-title>
      {{ (nombre || 'Sin nombre') | titlecase }}
      <ion-icon name="shield-checkmark" color="success" *ngIf="isVerified" class="verified-badge" aria-label="Verificado"></ion-icon>
    </ion-card-title>
    <ion-card-subtitle>
      {{ tipoMascota | titlecase }},
      {{ etapaVida === 'cachorro' ? edadMeses + ' meses' : edadAnios + ' años' }}
    </ion-card-subtitle>
    <div *ngIf="location" class="location-badge">
      <ion-icon name="location-outline" aria-hidden="true"></ion-icon>
      <span>{{ location }}</span>
    </div>
    <div class="card-actions">
      <ion-button 
        fill="clear" 
        class="action-btn" 
        (click)="onToggleFavorite()" 
        [class.is-favorite]="isFavorite"
        [attr.aria-label]="isFavorite ? 'Quitar de favoritos' : 'Agregar a favoritos'"
        [attr.aria-pressed]="isFavorite">
        <ion-spinner *ngIf="isFavoriteInFlight" name="crescent" aria-hidden="true"></ion-spinner>
        <ion-icon *ngIf="!isFavoriteInFlight" [name]="isFavorite ? 'heart' : 'heart-outline'" aria-hidden="true"></ion-icon>
      </ion-button>
      <ion-button 
        *ngIf="!isOwner" 
        fill="clear" 
        class="action-btn" 
        (click)="onReport()"
        aria-label="Reportar publicación">
        <ion-icon name="alert-circle-outline" aria-hidden="true"></ion-icon>
      </ion-button>
    </div>
  </ion-card-header>
  <ion-card-content>
    {{ descripcion || 'No hay descripción disponible' }}
  </ion-card-content>

  <div class="key-attributes" *ngIf="sexo || tamano || esterilizado" role="list" aria-label="Atributos de la mascota">
    <div class="attribute-item" *ngIf="sexo" role="listitem">
      <ion-icon [name]="sexo === 'macho' ? 'male-outline' : 'female-outline'" color="tertiary" aria-hidden="true"></ion-icon>
      <span>{{ sexo | titlecase }}</span>
    </div>
    <div class="attribute-item" *ngIf="tamano" role="listitem">
      <ion-icon name="resize-outline" color="secondary" aria-hidden="true"></ion-icon>
      <span>{{ tamano | titlecase }}</span>
    </div>
    <div class="attribute-item" *ngIf="esterilizado" role="listitem">
      <ion-icon name="medkit-outline" color="primary" aria-hidden="true"></ion-icon>
      <span>Esterilizado</span>
    </div>
  </div>

  <div class="button-container" aria-label="Acciones de adopción">
    <ion-button 
      expand="block"
      size="large"
      class="details-button" 
      (click)="onDetailsClick()"
      [attr.aria-label]="'Ver detalles completos de ' + (nombre || 'esta mascota')">
      <ion-icon name="sparkles-outline" slot="start" aria-hidden="true"></ion-icon>
      Conocer Más
      <ion-icon name="chevron-forward" slot="end" aria-hidden="true"></ion-icon>
    </ion-button>
    <p class="cta-hint">Incluye requisitos, tiempos estimados y contacto del cuidador.</p>
    <ion-button 
      *ngIf="status === 'adopted' && isOwner"
      expand="full" 
      color="success" 
      class="confirm-handover-button"
      (click)="onConfirmHandover()"
      [attr.aria-label]="'Confirmar que ' + nombre + ' fue entregado al adoptante'">
      <ion-icon name="hand-right-outline" slot="start" aria-hidden="true"></ion-icon>
      Confirmar Entrega
    </ion-button>
  </div>
</ion-card>
